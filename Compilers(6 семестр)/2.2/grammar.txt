Program -> Element
Program -> Program Element
Element -> COMMENT
Element -> Define
Define -> FUNCNAME Type DOUBLECOLON Type IS Patterns END
Type -> TYPENAME
Type -> '(' Types ')'
Type -> '*' Type

Types -> Type
Types -> Types ',' Type

Patterns -> Pattern
Patterns -> Patterns ';' Pattern
Pattern -> LCons '=' Expr

LCons -> LVal
LCons -> LCons ':' LVal

LVal -> VARNAME
LVal -> INT
LVal -> '(' LVals ')'
LVal -> '{' LVals '}'
LVal -> '{' '}'

LVals -> LCons
LVals -> LVals ',' LCons

Cons -> Val
Cons -> Cons ':' Val

Val -> FUNCNAME Val
Val -> VARNAME
Val -> INT
Val -> '[' Expr ']'
Val -> '(' Vals ')'
Val -> '{' Vals '}'
Val -> '{' '}'

Vals -> Cons
Vals -> Vals ',' Cons

Expr -> ExprElement
Expr -> Expr ExprOps

ExprOps -> ExprOp
ExprOps -> ExprOps ExprOp

ExprOp -> Op ExprElement
ExprElement -> Cons
